(window.webpackJsonp=window.webpackJsonp||[]).push([[340],{1374:function(e,n,t){"use strict";t.r(n);var a=t(3),r=t(237),o={show:!1,hasCompletedTeamOnboarding:!1},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n.type){case r.a.SET_SHOW_TEAM_ONBOARDING_MODAL:return Object(a.a)({},e,{show:n.show});case r.a.SET_HAS_COMPLETED_TEAM_ONBOARDING:return Object(a.a)({},e,{hasCompletedTeamOnboarding:!0});default:return e}},i=t(4),s=t.n(i),d=t(14),u=t(1),b=t(316),O=t(191),m=t(107),g=t(116),l=t(582),f=t(581),h=t(21),p={headers:{"Content-Type":"application/json",Accept:"application/json","cache-control":"no-cache"},query:{target:"organization",site_name:"sstk-org",setting_type:"organization"}},j="/user/settings";function T(){return Object(h.h)(j,Object(a.a)({method:"GET"},p))}function A(e){var n=e.reminderDate;return Object(h.h)(j,Object(a.a)({method:"PATCH",body:{modal_redisplay_date:n}},p))}var w={shouldOnboardTeamAdmin:s.a.mark((function e(){var n,t,a,r,o,c,i,g,h,p,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u.k)(l.a.selectIsAdminUserAndHasOrganizationId);case 3:return n=e.sent,e.next=6,Object(u.b)([Object(u.k)(b.a,{flag:"flag:team-onboarding"}),Object(u.k)(b.a,{flag:"flag:team-onboarding-mandatory-create-identity"})]);case 6:if(t=e.sent,a=Object(d.a)(t,2),r=a[0],o=a[1],c=r||o,n&&c){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,Object(u.k)(O.j);case 15:if(e.sent){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,Object(u.c)(T);case 20:if(i=e.sent,g=i.data.attributes,h=g.has_onboarded_team_name_and_logo,p=g.modal_redisplay_date,"true"!==h){e.next=28;break}return e.next=27,Object(u.i)(f.a.setHasCompletedTeamOnboarding());case 27:return e.abrupt("return");case 28:if(o||!p){e.next=33;break}if(j=new Date,!(new Date(p)>j)){e.next=33;break}return e.abrupt("return");case 33:return e.next=35,Object(u.i)(f.a.setShowTeamOnboardingModal({show:!0}));case 35:e.next=41;break;case 37:return e.prev=37,e.t0=e.catch(0),e.next=41,Object(u.c)(m.b.error,e.t0,"Error fetching user organization settings");case 41:case"end":return e.stop()}}),e,this,[[0,37]])})),dismissOnboardingModalAndSetReminderDate:s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.i)(f.a.setShowTeamOnboardingModal({show:!1}));case 2:return(n=new Date).setDate(n.getDate()+3),e.next=6,Object(u.c)(A,{reminderDate:n});case 6:case"end":return e.stop()}}),e,this)})),closeOnboardingModal:s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u.c)(w.dismissOnboardingModalAndSetReminderDate);case 3:return e.next=5,Object(u.i)(Object(g.u)());case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,Object(u.c)(m.b.error,e.t0,"Error dismissing the team onboarding modal");case 11:case"end":return e.stop()}}),e,this,[[0,7]])})),goToOnboardingProcess:s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u.c)(w.dismissOnboardingModalAndSetReminderDate);case 3:return e.next=5,Object(u.i)({type:"route/TEAM_ONBOARDING"});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,Object(u.c)(m.b.error,e.t0,"Error going to the onboarding process form");case 11:case"end":return e.stop()}}),e,this,[[0,7]])})),watchers:s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.b)([Object(u.o)(r.a.FETCH_TEAM_USER_SETTINGS,w.shouldOnboardTeamAdmin),Object(u.o)(r.a.CLOSE_ONBOARDING_MODAL,w.closeOnboardingModal),Object(u.o)(r.a.GO_TO_ONBOARDING_PROCESS,w.goToOnboardingProcess)]);case 2:case"end":return e.stop()}}),e,this)}))},x=w,_=t(3122);t.d(n,"ONBOARDING_MODAL",(function(){return M})),t.d(n,"register",(function(){return v})),t.d(n,"default",(function(){return _.a}));var M="onboardingModal",v=function(e){var n=e.registerReducer,t=e.registerWatchers;n(M,c),t(x.watchers)}},3122:function(e,n,t){"use strict";(function(e){var a=t(9),r=t.n(a),o=t(10),c=t.n(o),i=t(0),s=t.n(i),d=t(29),u=t(18),b=t(1975),O=t(94),m=t(581),g=t(582),l=function(){return c()({id:"../TeamAdminOnboardingModal",load:function(){return Promise.all([t.e(330).then(t.bind(null,4585))]).then((function(e){return e[0]}))},path:function(){return r.a.join(e,"../TeamAdminOnboardingModal")},resolve:function(){return 4585},chunkName:function(){return"TeamAdminOnboardingModal"}})},f=function(e){var n=e.isTeamAdminOnboardingMandatory,t=e.displayTeamAdminOnboardingModal,a=e.fetchTeamUserSettings;return Object(i.useEffect)((function(){a()}),[a]),n||t?s.a.createElement(O.c,{showMandatoryCreateIdentityModal:n,load:l}):null};f.defaultProps={isTeamAdminOnboardingMandatory:!1,displayTeamAdminOnboardingModal:!1,fetchTeamUserSettings:function(){}};var h={fetchTeamUserSettings:m.a.fetchTeamUserSettings};n.a=Object(d.compose)(Object(b.b)("flag:team-onboarding"),Object(b.b)("flag:team-onboarding-mandatory-create-identity"),Object(u.connect)((function(e,n){return{displayTeamAdminOnboardingModal:g.a.selectShouldOnboardTeamAdmin(e,n),isTeamAdminOnboardingMandatory:g.a.selectIsTeamAdminOnboardingMandatory(e,n)}}),h))(f)}).call(this,"/")}}]);
//# sourceMappingURL=340-feature-LazyTeamOnboardingModal-47044ac25f633ae682fc.js.map